{% extends "base.html" %}
{% import "macros/forms.html" as forms %}
{% block content %}
  {% if message %}
    <div class="alert alert-success">
      {{message}}
    </div>
  {% endif %}

  <h2>Ryhmät</h2>

  <table class="table table-bordered">
    <tbody>
      {% for group in groups %}
        <tr>
          <td><a href="{{base_path}}/group/{{group.id}}">{{group.name}}</a></td>
          {% set ids = [] %}
          {% for member in group.members %}
            {% set ids = ids|merge([member.id]) %}
          {% endfor %}

          {% if user_logged_in.id not in ids %}
            <td>
              <form method="post" action="{{base_path}}/group/{{group.id}}/join">
                <button type="submit" class="btn btn-primary btn-sm">Liity</button>
              </form>
            </td>
          {% else %}
            <td>{{forms.destroy_label("#{base_path}/group/#{group.id}/leave", "eroa")}}</td>
            <!--<td>{{forms.destroy_label("#{base_path}/group/#{group.id}/destroy")}}</td>-->
          {% endif %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <p>
    <a href="{{base_path}}/group/new" class="btn btn-primary">Uusi ryhmä</a>
  </p>
{% endblock %}
